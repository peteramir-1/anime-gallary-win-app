<section
  class="main-section h-[calc(100vh_-_4rem_-_50px)] w-full flex-col items-stretch gap-8">
  <article class="flex flex-row items-center gap-5">
    <button
      [routerLink]="['/library', 'details', anime.id]"
      class="btn btn-secondary">
      <ng-icon class="text-white" size="1rem" name="heroArrowLeft"></ng-icon>
    </button>
    <h3
      tabindex="1"
      #animeTitle
      class="text-xl font-semibold text-neutral-900 dark:text-white">
      {{ anime.name }}
    </h3>
  </article>
  <article class="flex h-full flex-row justify-between gap-5 overflow-hidden">
    <section class="flex h-full basis-3/4 flex-col gap-4" #videoContainer>
      <section class="mt-auto flex flex-row items-center justify-between">
        <button
          class="btn btn-secondary gap-3"
          [disabled]="+activeIndex === 0"
          [routerLink]="['/library', 'watch', anime.id]"
          [queryParams]="{ episodeIndex: +activeIndex - 1 }">
          <ng-icon size="1.25rem" name="heroArrowSmallLeft"></ng-icon> Previous
        </button>
        <h2 class="text-neutral-590 text-base font-bold dark:text-white">
          {{ +activeIndex + 1 }} of {{ episodes.length }}
        </h2>
        <button
          class="btn btn-secondary gap-3"
          [disabled]="+activeIndex === episodes.length - 1"
          [routerLink]="['/library', 'watch', anime.id]"
          [queryParams]="{ episodeIndex: +activeIndex + 1 }">
          Next <ng-icon size="1.25rem" name="heroArrowSmallRight"></ng-icon>
        </button>
      </section>
    </section>
    <section class="h-full w-[20%] rounded-lg border border-neutral-300 py-4">
      <cdk-virtual-scroll-viewport
        class="flex h-full flex-col gap-5 text-neutral-900 dark:text-white"
        appendOnly
        itemSize="40"
        minBufferPx="250"
        maxBufferPx="500">
        <section class="divide-y">
          <button
            class="w-full py-[20px] font-bold transition duration-200 hover:bg-neutral-300 hover:dark:bg-neutral-700"
            [ngClass]="{
              'bg-neutral-200 dark:bg-neutral-600': +activeIndex === i
            }"
            [routerLink]="['/library', 'watch', anime.id]"
            [queryParams]="{ episodeIndex: i }"
            *cdkVirtualFor="let episode of episodes; let i = index">
            {{ 'Episode ' + (i + 1) }}
          </button>
        </section>
      </cdk-virtual-scroll-viewport>
    </section>
  </article>
</section>
